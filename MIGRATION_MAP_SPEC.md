# Migration Map - Technical Specification
**Live Flight Paths for Bird Migration**

Version 1.0 - February 2026

---

## Table of Contents
1. [Concept Overview](#concept-overview)
2. [Core Algorithm](#core-algorithm)
3. [Data Structures](#data-structures)
4. [Visual Design](#visual-design)
5. [Interaction Design](#interaction-design)
6. [AI-Powered Path Inference](#ai-powered-path-inference)
7. [Performance Optimization](#performance-optimization)
8. [Implementation Phases](#implementation-phases)

---

## Concept Overview

### The Vision
> "You're at the beach in May. You open Aviary. The map shows glowing migration paths of birds passing through RIGHT NOW. Sanderlings refueling at Delaware Bay. Warblers streaming north. Arctic Terns on their epic journey."

### What Makes This Unique
**Existing tools show:** Where birds are (static heat maps, range maps)  
**Aviary shows:** Where birds are GOING (animated migration flows, temporal movement)

No one visualizes migration as a living, flowing system. This is the defining feature of Aviary.

### Design Principles
1. **AI does the heavy lifting** - Auto-groups, infers paths, filters to relevance
2. **Clean by default** - No toggles needed, one beautiful default view
3. **Temporal storytelling** - Time slider brings migration to life
4. **Graceful degradation** - Works globally, richer where data is better
5. **Mobile-first beauty** - Smooth 60fps animations, touch-optimized

---

## Core Algorithm

### High-Level Flow

```
User opens Migration Map
  ↓
System detects location (or shows global default)
  ↓
For current month + location:
  1. Find all migrant species present/passing
  2. Group by migration pattern (family + flyway + timing)
  3. Infer path from breeding/winter ranges + flyways
  4. Filter to ACTIVE migrations only (birds moving NOW)
  5. Limit to 5-8 groups (prevent clutter)
  6. Generate contextual narrative
  ↓
Render:
  - Map with animated paths
  - Time slider
  - Auto-generated status text
  - 1-3 pulsing hotspots (if relevant)
```

### Grouping Strategy

**Goal:** Show 350+ migrant species without visual chaos

**Method:** Intelligent clustering by:
1. **Taxonomic family** (Shorebirds, Warblers, Raptors, etc.)
2. **Flyway** (Atlantic, Pacific, Central, Mississippi)
3. **Migration timing** (spring vs fall, early vs late)

**Output:** 5-8 distinct "migration flows" each representing 5-50 species

**Example for Santa Barbara, May:**
```
Groups generated:
1. Shorebirds - Pacific Flyway (23 species)
   Exemplar: Sanderling
   Color: Blue
   Status: Northbound, active
   
2. Warblers - Pacific Flyway (18 species)
   Exemplar: Yellow Warbler
   Color: Gold
   Status: Northbound, peak now
   
3. Raptors - Pacific Flyway (5 species)
   Exemplar: Swainson's Hawk
   Color: Red
   Status: Northbound, early arrivals

... (5-8 total groups)
```

---

## Data Structures

### Migration Group Schema

```javascript
{
  "groupId": "shorebirds-atlantic-spring",
  "family": "Shorebirds",
  "familyScientific": "Scolopacidae",
  "flyway": "Atlantic",
  "color": "#4A90E2",  // Blue
  "speciesCount": 23,
  "exemplarSpecies": {
    "code": "sander",
    "commonName": "Sanderling",
    "abundanceRank": 1  // Most common in group
  },
  "allSpecies": [
    "Sanderling",
    "Dunlin", 
    "Red Knot",
    "Ruddy Turnstone",
    // ... up to 23
  ],
  "route": {
    "type": "inferred",  // or "verified" for well-studied species
    "confidence": "high",  // high, medium, low
    "points": [
      {
        "lat": -35.5,
        "lng": -57.5,
        "name": "South American Coast",
        "role": "winter",
        "months": [12, 1, 2, 3]
      },
      {
        "lat": 25.8,
        "lng": -80.2,
        "name": "Florida Coast",
        "role": "stopover",
        "months": [4],
        "isHotspot": false
      },
      {
        "lat": 39.2,
        "lng": -75.1,
        "name": "Delaware Bay",
        "role": "critical-stopover",
        "months": [5, 6],
        "isHotspot": true,
        "peakAbundance": 100000,
        "significance": "Horseshoe crab eggs - birds double body weight"
      },
      {
        "lat": 75.0,
        "lng": -95.0,
        "name": "High Arctic Tundra",
        "role": "breeding",
        "months": [6, 7, 8]
      }
    ]
  },
  "timing": {
    "northbound": {
      "start": { month: 3, location: "South America" },
      "peak": { month: 5, location: "Mid-Atlantic" },
      "end": { month: 6, location: "Arctic" }
    },
    "southbound": {
      "start": { month: 7, location: "Arctic" },
      "peak": { month: 9, location: "Atlantic Coast" },
      "end": { month: 11, location: "South America" }
    }
  },
  "narrative": {
    // Auto-generated by Claude for each month
    "5": "Peak spring migration. These shorebirds are refueling at Delaware Bay, gorging on horseshoe crab eggs to double their body weight before the final 2,000km push to Arctic breeding grounds.",
    "7": "Breeding season. Birds are nesting on Arctic tundra. Adults will begin return migration in late July.",
    "1": "Winter grounds. Concentrated along South American and southern US coasts."
  }
}
```

### Hotspot Data Schema

```javascript
{
  "hotspotId": "delaware-bay",
  "name": "Delaware Bay",
  "location": { "lat": 39.2, "lng": -75.1 },
  "type": "critical-stopover",
  "families": ["Shorebirds"],  // Which groups use this
  "peakMonths": [5, 6],
  "peakAbundance": 100000,
  "significance": "One of the most important shorebird stopovers in the Western Hemisphere. Horseshoe crab eggs provide essential fuel.",
  "species": [
    { name: "Red Knot", abundance: 30000 },
    { name: "Sanderling", abundance: 25000 },
    { name: "Ruddy Turnstone", abundance: 20000 },
    { name: "Semipalmated Sandpiper", abundance: 15000 }
  ],
  "visualization": {
    "pulseAnimation": true,
    "glowIntensity": "high",
    "labelPosition": "above"
  }
}
```

### Path Rendering Data

```javascript
{
  "pathId": "shorebirds-atlantic-spring",
  "svgPath": "M -35.5 -57.5 Q 10 -70, 25.8 -80.2 T 39.2 -75.1 Q 60 -80, 75 -95",
  // Smooth bezier curve through points
  
  "visualization": {
    "strokeColor": "#4A90E2",
    "strokeWidth": {
      "base": 3,
      "scaled": true  // Thickness varies by abundance
    },
    "opacity": {
      "1": 0.2,   // January - dim (wintering)
      "3": 0.5,   // March - starting
      "5": 1.0,   // May - peak (ACTIVE)
      "7": 0.3,   // July - breeding
      "9": 0.8,   // September - southbound
      "12": 0.2   // December - wintering
    },
    "animation": {
      "type": "flow-particles",
      "direction": {
        "3-6": "northward",   // Spring
        "7-11": "southward"   // Fall
      },
      "particleCount": 12,
      "speed": {
        "1-2": "stopped",
        "3-6": "fast",
        "7": "stopped",
        "8-11": "fast",
        "12": "stopped"
      }
    }
  }
}
```

---

## Visual Design

### Color Coding (Family-Based)

**Global consistency - same colors worldwide:**

```javascript
const FAMILY_COLORS = {
  "Shorebirds": "#4A90E2",      // Blue (water association)
  "Warblers": "#F5D547",        // Gold/Yellow (bright songbirds)
  "Raptors": "#E84A3D",         // Red (predators)
  "Waterfowl": "#45B7A0",       // Teal (ducks, geese)
  "Terns": "#7EC8E3",           // Light blue (seabirds)
  "Swallows": "#9B6FB0",        // Purple (aerial)
  "Thrushes": "#8B6F47",        // Brown (robins, etc.)
  "Sparrows": "#95A5A6"         // Gray (LBJs)
};
```

### Map Layers (Bottom to Top)

```
1. Base Map (OpenStreetMap or Mapbox)
   - Muted colors (grays, light blues)
   - Simplified (no labels except major cities)
   - Focus on coastlines, major water bodies

2. Heat Map Layer (All Birds - Subtle Background)
   - Opacity: 0.3
   - Color: Single green gradient
   - Shows: All species present (residents + migrants)
   - Purpose: Context, not focus

3. Migration Paths Layer (Foreground - THE FEATURE)
   - Opacity: 0.6-1.0 (varies by activity)
   - Colors: Family colors (8 distinct)
   - Animation: Flowing particles
   - Purpose: Primary visual

4. Hotspot Markers Layer
   - 1-3 pulsing circles
   - Only active hotspots shown
   - Labels on tap

5. User Location Marker
   - Distinct pin/circle
   - Always visible
   - "You are here" label
```

### Mobile Layout (Revised)

```
┌──────────────────────────────────┐
│ Migration Map               [≡]  │ ← Minimal header (40px)
├──────────────────────────────────┤
│                                  │
│                                  │
│        [INTERACTIVE MAP]         │ ← 75% viewport height
│                                  │   Full bleed, edge-to-edge
│    ◉ You are here                │
│                                  │   Layers:
│    [5-8 animated paths]          │   - Base map
│    [1-3 pulsing hotspots]        │   - Heat (subtle)
│                                  │   - Paths (bold)
│                                  │   - Hotspots (pulsing)
│    Santa Barbara, CA             │   - Your location
│                                  │
│    ▼ Peak Spring Migration       │ ← Status overlay (bottom)
│    47 species passing through    │   Semi-transparent bg
│                                  │   Auto-generated text
│    Jan ━━━━━●━━━━━━━━━━━━━ Dec  │ ← Time slider (overlay)
│                                  │   Integrated into map
│    [▶ Play]         [Legend ≡]  │ ← Controls (corners)
│                                  │
└──────────────────────────────────┘
              ↓ Scroll

┌──────────────────────────────────┐
│ What's Flying Through            │ ← Section header
│                                  │   Clean, simple
│ ──── Shorebirds (23 species)     │ ← Color-coded headers
│                                  │   Match map paths
│ Sanderling • Dunlin • Red Knot   │ ← Top 3 species
│                                  │
│ Arctic Coast → Delaware Bay      │ ← Route summary
│ → High Arctic                    │   Simple text
│                                  │
│ Peak: Now through June           │ ← Timing
│                                  │
│ [Explore shorebirds →]           │ ← CTA
│                                  │
│ ──── Warblers (18 species)       │
│ ... (repeat structure)           │
│                                  │
│ [5-8 total groups listed]        │
│                                  │
└──────────────────────────────────┘
              ↓

┌──────────────────────────────────┐
│ All Birds Here Now               │ ← Traditional section
│                                  │   Familiar territory
│ 127 species total in May         │
│ 47 migrating • 80 year-round     │
│                                  │
│ [Grid ●] [List ○]                │ ← Standard controls
│ Sort: [Most common ▾]            │
│                                  │
│ [Bird cards/list as before...]   │ ← Existing design
└──────────────────────────────────┘
```

### Path Visual Treatment

**SVG Implementation:**

```html
<svg class="migration-paths-layer">
  <!-- Shorebird path -->
  <path
    d="M -35.5 -57.5 Q 10 -70, 25.8 -80.2 T 39.2 -75.1 Q 60 -80, 75 -95"
    stroke="#4A90E2"
    stroke-width="3"
    stroke-dasharray="10 5"
    fill="none"
    opacity="1.0"
    class="migration-path active"
  />
  
  <!-- Animated particles along path -->
  <g class="path-particles">
    <circle r="4" fill="#4A90E2" opacity="0.8">
      <animateMotion
        dur="6s"
        repeatCount="indefinite"
        path="M -35.5 -57.5 Q 10 -70, 25.8 -80.2 T 39.2 -75.1 Q 60 -80, 75 -95"
      />
    </circle>
    <!-- 8-12 more particles at different offsets -->
  </g>
</svg>
```

**CSS Animations:**

```css
.migration-path {
  transition: opacity 0.5s ease, stroke-width 0.3s ease;
  filter: drop-shadow(0 0 4px currentColor);
}

.migration-path.active {
  opacity: 1.0;
  animation: glow 2s ease-in-out infinite;
}

.migration-path.inactive {
  opacity: 0.3;
  animation: none;
}

@keyframes glow {
  0%, 100% { filter: drop-shadow(0 0 4px currentColor); }
  50% { filter: drop-shadow(0 0 12px currentColor); }
}

.hotspot-marker {
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { 
    transform: scale(1); 
    opacity: 1; 
  }
  50% { 
    transform: scale(1.4); 
    opacity: 0.5; 
  }
}
```

---

## Interaction Design

### Primary Interaction: Time Slider

**Behavior as user drags:**

```javascript
// Month-by-month state changes
const MONTH_STATES = {
  1: {  // January
    pathOpacity: 0.2,
    animation: "paused",
    narrative: "Migration quiet - birds at winter grounds",
    visualization: "clustering"  // Show concentrations, not movement
  },
  3: {  // March
    pathOpacity: 0.6,
    animation: "slow",
    narrative: "Spring migration beginning - early arrivals",
    visualization: "emerging-flows"
  },
  5: {  // May
    pathOpacity: 1.0,
    animation: "fast",
    narrative: "Peak spring migration - 47 species passing through",
    visualization: "maximum-activity",
    hotspots: ["Delaware Bay", "Platte River"]  // Pulse these
  },
  7: {  // July
    pathOpacity: 0.3,
    animation: "paused",
    narrative: "Breeding season - birds nesting in Arctic",
    visualization: "clustering"
  },
  9: {  // September
    pathOpacity: 0.8,
    animation: "fast-reverse",
    narrative: "Fall migration - return journey south",
    visualization: "southbound-flows"
  },
  12: {  // December
    pathOpacity: 0.2,
    animation: "paused",
    narrative: "Winter grounds - concentrated at southern sites",
    visualization: "clustering"
  }
};

// Smooth transitions between months
function updateMapForMonth(month) {
  const state = MONTH_STATES[month];
  
  // Update path visibility
  migrationPaths.forEach(path => {
    path.style.opacity = state.pathOpacity;
    path.dataset.animation = state.animation;
  });
  
  // Update narrative text
  narrativeElement.textContent = state.narrative;
  
  // Update hotspot visibility
  updateHotspots(month);
  
  // Trigger animation state change
  updateAnimations(state.animation);
}
```

### Secondary Interaction: Tap Path

```
User taps blue shorebird path
  ↓
Modal slides up from bottom (mobile) or center (desktop):

┌────────────────────────────────┐
│ ──── Shorebirds                │ ← Color bar matches path
│ Atlantic Flyway                │
│                                │
│ 23 species including:          │
│ • Sanderling                   │ ← Top 5 by abundance
│ • Dunlin                       │
│ • Red Knot                     │
│ • Ruddy Turnstone              │
│ • Semipalmated Sandpiper       │
│                                │
│ Journey                        │
│ From: South American coast     │
│ To: High Arctic tundra         │
│ Distance: 5,000-10,000 km      │
│                                │
│ Critical Stopovers             │
│ • Delaware Bay (May)           │ ← Listed, with timing
│ • James Bay (August)           │
│                                │
│ [See all 23 species →]         │ ← CTA to filtered list
│                      [Close]   │
└────────────────────────────────┘
```

### Tertiary Interaction: Tap Hotspot

```
User taps pulsing Delaware Bay marker
  ↓
Modal with hotspot details:

┌────────────────────────────────┐
│ Delaware Bay                   │
│ Critical Shorebird Stopover    │
│                                │
│ Right now (May 15):            │
│ ~100,000 shorebirds            │
│                                │
│ What's happening:              │
│ Birds are gorging on horseshoe │
│ crab eggs, doubling their body │
│ weight in 2 weeks for final    │
│ push to Arctic.                │
│                                │
│ Top species here:              │
│ • Red Knot (30,000)            │
│ • Sanderling (25,000)          │
│ • Ruddy Turnstone (20,000)     │
│                                │
│ [Learn more] [Close]           │
└────────────────────────────────┘
```

### Play Button

```
User taps [▶ Play]
  ↓
Auto-animates through year:
- Slider advances Jan → Dec
- Takes 30 seconds total (~2.5s per month)
- Pauses briefly at peak months (May, September)
- Paths animate, hotspots pulse on cue
- Narrative updates

Controls during playback:
[⏸ Pause] [⏮ Restart] [Speed: 2x ▾]

User can still drag slider to take control
```

### Legend Toggle

```
[Legend ≡]
  ↓ Tap
Small overlay in corner:

┌──────────────────┐
│ Migration Flows  │
│                  │
│ ──── Shorebirds  │
│ ──── Warblers    │
│ ──── Raptors     │
│ ──── Waterfowl   │
│ ... (active only)│
│                  │
│ ◉ Hotspot (peak) │
│ ○ Your location  │
│                  │
│     [Close ×]    │
└──────────────────┘

Tap any family name → highlights that path
Tap again → dehighlights
```

---

## AI-Powered Path Inference

### The Challenge

**We have:** Breeding ranges + Winter ranges + Migration timing  
**We need:** Smooth, realistic flight paths between them

**Can't hand-code:** 350+ migrant species × multiple flyways = thousands of paths

**Solution:** Claude AI infers paths from data + known migration patterns

### Inference Algorithm

**Inputs:**
1. Breeding range polygon (from eBird)
2. Winter range polygon (from eBird)
3. Species family (taxonomic)
4. Known flyway corridors (Atlantic, Pacific, Central, Mississippi)
5. Documented stopover sites (from literature)

**Process:**

```javascript
async function inferMigrationPath(species, family, flyway) {
  const prompt = `
    Given this bird species:
    - Name: ${species.commonName}
    - Family: ${family}
    - Breeding range centroid: ${species.breeding.centroid}
    - Winter range centroid: ${species.winter.centroid}
    - Known flyway: ${flyway}
    
    Known facts:
    - ${family} typically use ${flyway} flyway
    - Major stopover sites in this flyway: ${flyway.stopovers}
    - Species is documented at: ${species.documentedLocations}
    
    Infer a realistic migration path as a series of 4-6 waypoints:
    - Start at winter centroid
    - Follow known flyway corridor
    - Include documented stopovers if on route
    - End at breeding centroid
    - Return as lat/lng coordinates with month of passage
    
    Confidence level: high/medium/low based on data quality
  `;
  
  const response = await claude.generatePath(prompt);
  
  return {
    path: response.waypoints,
    confidence: response.confidence,
    reasoning: response.reasoning
  };
}
```

**Output Example:**

```json
{
  "path": [
    {"lat": -34.5, "lng": -58.4, "month": 3, "name": "Argentina Coast"},
    {"lat": 10.5, "lng": -61.4, "month": 4, "name": "Venezuela Coast"},
    {"lat": 25.8, "lng": -80.2, "month": 4, "name": "Florida"},
    {"lat": 39.2, "lng": -75.1, "month": 5, "name": "Delaware Bay"},
    {"lat": 54.5, "lng": -79.8, "month": 6, "name": "James Bay"},
    {"lat": 75.0, "lng": -95.0, "month": 6, "name": "High Arctic"}
  ],
  "confidence": "high",
  "reasoning": "Route follows documented Atlantic Flyway. Delaware Bay is well-documented critical stopover for this family."
}
```

### Confidence Tracking

**We track which paths are confident vs inferred:**

```javascript
{
  "pathId": "shorebirds-atlantic",
  "confidence": "high",
  "evidenceScore": 8.5,  // Out of 10
  "basedOn": [
    "eBird abundance data (52 weeks)",
    "BirdLife range maps",
    "Published migration studies (3 papers)",
    "Citizen science observations (10,000+ records)"
  ],
  "gaps": []  // What we're missing
}

vs

{
  "pathId": "rare-tropical-flycatcher",
  "confidence": "low",
  "evidenceScore": 3.2,
  "basedOn": [
    "eBird range maps (sparse data)",
    "Family-level inference"
  ],
  "gaps": [
    "No weekly abundance data",
    "No documented stopovers",
    "Limited observations (<50 records)"
  ]
}
```

**Display strategy:**
- **High confidence (8+):** Show path normally
- **Medium confidence (5-7):** Show path with lighter opacity, note "inferred" in modal
- **Low confidence (<5):** Don't show path, add to backlog for manual research

### Completeness Tracking

**Internal dashboard tracks coverage:**

```javascript
{
  "totalMigrantSpecies": 3847,
  "withHighConfidencePaths": 892,  // 23%
  "withMediumConfidencePaths": 1654,  // 43%
  "withLowConfidencePaths": 801,  // 21%
  "noPaths": 500,  // 13%
  
  "coverageByRegion": {
    "North America": {
      "total": 350,
      "high": 245,  // 70%
      "medium": 89,
      "low": 16
    },
    "Europe": {
      "total": 280,
      "high": 168,  // 60%
      "medium": 87,
      "low": 25
    },
    "Africa": {
      "total": 420,
      "high": 105,  // 25% - trans-Saharan less studied
      "medium": 189,
      "low": 126
    }
    // ... other regions
  },
  
  "improvementQueue": [
    {
      "species": "Bar-tailed Godwit",
      "currentConfidence": "medium",
      "priority": "high",
      "reason": "Epic migration (11,000km non-stop), worthy of showcase",
      "needsResearch": ["Exact Pacific route", "Stopover sites"]
    }
    // ... prioritized list
  ]
}
```

**This lets us:**
- Show users what we have vs don't have
- Prioritize research/enhancement efforts
- Gradually improve coverage
- Be transparent about data quality

---

## Performance Optimization

### Challenge

Animated map with 5-8 paths, 10-30 particles, 1-3 pulsing hotspots, time slider updates — all at 60fps on mobile.

### Optimization Strategies

#### 1. Use SVG for Paths, CSS for Animations

```javascript
// Good: Hardware-accelerated CSS
.migration-path {
  transition: opacity 0.5s ease;
  will-change: opacity;  // GPU optimization hint
}

// Avoid: JavaScript animation loop
// setInterval(() => { path.style.opacity = ... }, 16);  // BAD
```

#### 2. Limit Active Elements

```javascript
const MAX_PATHS = 8;
const MAX_PARTICLES_PER_PATH = 4;
const MAX_HOTSPOTS = 3;

// Total animated elements: ~35 max
// Manageable for 60fps
```

#### 3. Lazy Rendering

```javascript
// Only render paths that are visible (opacity > 0.1)
function updateVisiblePaths(month) {
  const state = MONTH_STATES[month];
  
  allPaths.forEach(path => {
    const shouldRender = state.pathOpacity > 0.1;
    
    if (shouldRender && !path.rendered) {
      renderPath(path);  // Add to DOM
      path.rendered = true;
    } else if (!shouldRender && path.rendered) {
      removePath(path);  // Remove from DOM
      path.rendered = false;
    }
  });
}
```

#### 4. Debounce Slider

```javascript
// Don't update on every pixel drag
const debouncedUpdate = debounce((month) => {
  updateMapForMonth(month);
}, 100);  // Update max 10x per second

slider.addEventListener('input', (e) => {
  const month = parseInt(e.target.value);
  debouncedUpdate(month);
});
```

#### 5. Progressive Enhancement

```javascript
// Detect device performance
const performanceLevel = detectPerformance();

if (performanceLevel === 'high') {
  // Full experience: smooth animations, particles, glows
  enableAllAnimations();
  particlesPerPath = 4;
} else if (performanceLevel === 'medium') {
  // Reduced: simpler animations, fewer particles
  enableBasicAnimations();
  particlesPerPath = 2;
} else {
  // Low: static paths, no particles
  disableAnimations();
  particlesPerPath = 0;
}

function detectPerformance() {
  // Check hardware concurrency, memory, user agent
  const cores = navigator.hardwareConcurrency || 2;
  const isLowEnd = /Android.*Chrome\/[1-5]/i.test(navigator.userAgent);
  
  if (cores >= 4 && !isLowEnd) return 'high';
  if (cores >= 2) return 'medium';
  return 'low';
}
```

#### 6. Virtualize Off-Screen Elements

```javascript
// Don't render paths/hotspots outside viewport
function isInViewport(lat, lng) {
  const bounds = map.getBounds();
  return bounds.contains([lat, lng]);
}

// Only render visible elements
visiblePaths = allPaths.filter(p => 
  p.points.some(point => isInViewport(point.lat, point.lng))
);
```

#### 7. Use Web Workers for Heavy Computation

```javascript
// Offload path calculations to worker thread
const worker = new Worker('migration-calculator.js');

worker.postMessage({
  type: 'generatePaths',
  location: userLocation,
  month: currentMonth,
  species: allSpecies
});

worker.onmessage = (e) => {
  const { paths, hotspots, narrative } = e.data;
  renderPaths(paths);
  renderHotspots(hotspots);
  updateNarrative(narrative);
};
```

### Performance Targets

```
Desktop:
- 60fps animations (16.6ms per frame)
- Time to interactive: <2s
- Smooth slider dragging (no jank)

Mobile (iPhone 12+):
- 60fps animations
- Time to interactive: <3s
- Smooth touch interactions

Mobile (Older devices):
- 30fps acceptable (33ms per frame)
- Reduced animations
- Time to interactive: <5s
```

---

## Implementation Phases

### Phase 1: Foundation (Weeks 1-3)

**Goal:** Basic map with static paths for North America

**Tasks:**
1. Set up base map (Mapbox or Leaflet + OpenStreetMap)
2. Implement time slider component
3. Create 8 family color scheme
4. Build path data structure
5. Manually define 5-10 showcase paths (well-studied species)
   - Sanderling (Atlantic Flyway)
   - Arctic Tern (Global champion)
   - Bar-tailed Godwit (Pacific record-holder)
   - Ruby-throated Hummingbird (Gulf crossing)
   - Swainson's Hawk (Americas champion)
6. Render static SVG paths on map
7. Basic opacity changes with slider (no animation yet)

**Deliverable:** Map shows paths, slider changes visibility

---

### Phase 2: Animation & Interactivity (Weeks 4-5)

**Goal:** Bring paths to life

**Tasks:**
1. Implement CSS animations (glow, fade)
2. Add flowing particles along paths
3. Month-based animation states (active/inactive)
4. Tap path → modal with details
5. Auto-generated narrative for each month
6. Play button (auto-advance through year)
7. Legend overlay

**Deliverable:** Animated, interactive migration map (North America, 10 paths)

---

### Phase 3: AI Path Generation (Weeks 6-8)

**Goal:** Scale from 10 paths to 100+

**Tasks:**
1. Build Claude prompt for path inference
2. Integrate eBird range data
3. Define known flyway corridors
4. Generate paths for all North American migrants (~350 species)
5. Review confidence scores
6. Filter to high-confidence only (show ~100 paths)
7. Implement grouping algorithm (reduce 100 → 8 groups)
8. Test across different locations/months

**Deliverable:** Migration map works anywhere in North America, auto-generates relevant paths

---

### Phase 4: Hotspots & Narratives (Weeks 9-10)

**Goal:** Add spectacle moments

**Tasks:**
1. Define 20-30 critical hotspots (Delaware Bay, Platte River, etc.)
2. Implement pulsing marker animation
3. Tap hotspot → detailed modal
4. Claude generates hotspot narratives
5. Logic to show 1-3 active hotspots per month
6. Integrate hotspots into path modals

**Deliverable:** Map highlights migration spectacles, tells richer stories

---

### Phase 5: Global Expansion (Weeks 11-12)

**Goal:** Extend beyond North America

**Tasks:**
1. Generate paths for European migrants (trans-Saharan routes)
2. Generate paths for East Asian-Australasian flyway
3. Generate paths for Neotropical migrants
4. Test degradation in data-sparse regions (tropics, Southern Hemisphere)
5. Confidence thresholds by region

**Deliverable:** Global migration map, gracefully handles all regions

---

### Phase 6: Polish & Optimization (Weeks 13-14)

**Goal:** Production-ready performance

**Tasks:**
1. Performance profiling on mobile devices
2. Implement progressive enhancement
3. Optimize animations for 60fps
4. Lazy loading, virtualization
5. Error states (no active migrations, location not found)
6. Accessibility (keyboard navigation, screen reader support)
7. Loading states, skeleton screens

**Deliverable:** Fast, smooth, production-ready

---

### Phase 7: Integration (Week 15)

**Goal:** Connect to rest of Aviary

**Tasks:**
1. Replace original Explore page with Migration Map
2. Link paths to species pages
3. "See all shorebirds" → filtered species list
4. Add to main navigation
5. Update About page to mention this feature
6. Analytics tracking (which paths get clicked, popular months)

**Deliverable:** Migration Map is live as main Explore experience

---

## Success Metrics

**Engagement:**
- Time on Migration Map page
- Slider interactions per session
- Path/hotspot tap rate

**Educational Value:**
- "Aha moments" - users discovering migration they didn't know about
- Shares on social media
- Inbound links from birding communities

**Technical:**
- 60fps animation on target devices
- <3s time to interactive
- <5% error rate (failed path rendering, etc.)

**Coverage:**
- High-confidence paths: 30% of migrants (Year 1)
- Medium-confidence: 50% (Year 1)
- Continual improvement toward 80%+ high-confidence

---

## Open Questions & Future Enhancements

### Data Quality Improvements
- Partner with migration researchers for verified routes
- Incorporate GPS tracking data where available
- Crowdsource path corrections from expert birders

### Additional Features (Future)
- Historical migration (compare 2020 vs 2025)
- Climate change impacts (routes shifting over time)
- "Follow a bird" mode (pick one species, see full year cycle)
- Rare vagrant alerts (unusual migration patterns)
- Educational mode for teachers (lesson plans, quizzes)

### Accessibility
- Audio descriptions of migration flows
- High-contrast mode for visibility
- Simplified static version for screen readers

---

*Last updated: February 14, 2026*
